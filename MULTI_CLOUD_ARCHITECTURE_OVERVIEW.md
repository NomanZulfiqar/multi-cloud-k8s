# Multi-Cloud Kubernetes Architecture Overview

## ğŸ—ï¸ **Complete Multi-Cloud Architecture**

This project implements a **production-ready multi-cloud Kubernetes platform** that automatically deploys applications across **AWS EKS** and **Azure AKS** with centralized secret management, database services, and CI/CD automation.

## ğŸ”„ **How the Architecture Runs**

### **Runtime Flow:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Developer     â”‚    â”‚   GitHub        â”‚    â”‚   Multi-Cloud   â”‚
â”‚   Commits Code  â”‚â”€â”€â”€â–¶â”‚   Actions       â”‚â”€â”€â”€â–¶â”‚   Deployment    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Terraform     â”‚
                    â”‚   Provisions    â”‚
                    â”‚   Infrastructureâ”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Docker Build  â”‚
                    â”‚   & Push to     â”‚
                    â”‚   Registries    â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Kubernetes    â”‚
                    â”‚   Deployment    â”‚
                    â”‚   (Helm Charts) â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Multi-Cloud Synchronization:**
- **Parallel Deployment**: Both clouds deploy simultaneously
- **Shared Backend**: Terraform state stored in AWS S3
- **Consistent Configuration**: Same application, different cloud services
- **Independent Scaling**: Each cloud scales based on its own metrics

## ğŸ—ï¸ **Architecture Summary**

### **AWS EKS Environment**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        AWS EKS CLUSTER                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚   Application   â”‚  â”‚   PostgreSQL    â”‚  â”‚   Redis     â”‚ â”‚
â”‚  â”‚   (LoadBalancer)â”‚  â”‚   (RDS)         â”‚  â”‚(ElastiCache)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           External Secrets Operator                    â”‚ â”‚
â”‚  â”‚     (Syncs from AWS Secrets Manager)                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  VPC: Custom VPC with public/private subnets               â”‚
â”‚  Region: us-east-1                                         â”‚
â”‚  IAM: IRSA (IAM Roles for Service Accounts)               â”‚
â”‚  Storage: ECR for container images                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Azure AKS Environment**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                       AZURE AKS CLUSTER                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚  â”‚   Application   â”‚  â”‚   PostgreSQL    â”‚                  â”‚
â”‚  â”‚   (LoadBalancer)â”‚  â”‚   (Helm Chart)  â”‚                  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚           External Secrets Operator                    â”‚ â”‚
â”‚  â”‚     (Syncs from Azure Key Vault)                     â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Resource Group: aks-rg                                    â”‚
â”‚  Region: East US                                           â”‚
â”‚  Networking: Azure CNI                                     â”‚
â”‚  Storage: ACR for container images                         â”‚
â”‚  Secrets: Azure Key Vault (myapp-kv-2024)                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ **Pipeline Phases Breakdown**

### **AWS EKS Pipeline Phases**

#### **Phase 1: Infrastructure Planning (terraform-plan)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Checkout Code                                                  â”‚
â”‚ 2. Configure AWS Credentials                                      â”‚
â”‚ 3. Setup Terraform                                               â”‚
â”‚ 4. Terraform Init (Download providers & modules)                 â”‚
â”‚ 5. Import Existing Resources (EKS, RDS, ElastiCache, ECR)        â”‚
â”‚ 6. Terraform Format & Validate                                   â”‚
â”‚ 7. Terraform Plan (Generate execution plan)                      â”‚
â”‚ 8. Upload Plan Artifact                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 2: Infrastructure Provisioning (terraform-apply)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Download Terraform Plan                                        â”‚
â”‚ 2. VPC Mismatch Cleanup (Detect & fix subnet group conflicts)    â”‚
â”‚ 3. Import Existing Resources (Handle state drift)                â”‚
â”‚ 4. Terraform Apply (Create/Update infrastructure):               â”‚
â”‚    â€¢ VPC with public/private subnets                            â”‚
â”‚    â€¢ EKS Cluster with node groups                               â”‚
â”‚    â€¢ RDS PostgreSQL instance                                   â”‚
â”‚    â€¢ ElastiCache Redis cluster                                 â”‚
â”‚    â€¢ ECR repository                                            â”‚
â”‚    â€¢ IAM roles (EKS, External Secrets)                        â”‚
â”‚    â€¢ Security groups & networking                             â”‚
â”‚    â€¢ AWS Secrets Manager secret                               â”‚
â”‚ 5. Save Terraform Outputs                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 3: Container Build & Push (build-and-push)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Login to Amazon ECR                                            â”‚
â”‚ 2. Get ECR Repository URL (from account ID)                      â”‚
â”‚ 3. Build Docker Image:                                           â”‚
â”‚    â€¢ Use application source code                                 â”‚
â”‚    â€¢ Install dependencies                                       â”‚
â”‚    â€¢ Create optimized container                                â”‚
â”‚ 4. Tag Image with ECR URL                                        â”‚
â”‚ 5. Push to ECR Repository                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 4: Kubernetes Deployment (deploy-kubernetes)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Setup kubectl & Helm                                           â”‚
â”‚ 2. Create aws-auth ConfigMap (Node access to cluster)            â”‚
â”‚ 3. Create ECR Pull Secret                                         â”‚
â”‚ 4. Install External Secrets Operator:                           â”‚
â”‚    â€¢ Add Helm repository                                        â”‚
â”‚    â€¢ Install with CRDs                                          â”‚
â”‚    â€¢ Wait for pods to be ready                                 â”‚
â”‚    â€¢ Verify CRDs installation                                  â”‚
â”‚ 5. Configure External Secrets:                                   â”‚
â”‚    â€¢ Create service account with IAM role                      â”‚
â”‚    â€¢ Restart External Secrets pods                             â”‚
â”‚    â€¢ Delete webhook configurations (timeout fix)               â”‚
â”‚    â€¢ Create SecretStore (AWS Secrets Manager)                  â”‚
â”‚    â€¢ Create ExternalSecret (sync db credentials)               â”‚
â”‚    â€¢ Monitor secret creation                                   â”‚
â”‚ 6. Deploy Database (PostgreSQL via Helm)                         â”‚
â”‚ 7. Deploy Application (Custom Helm chart)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Azure AKS Pipeline Phases**

#### **Phase 1: Infrastructure Planning (terraform-plan)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Azure Login & AWS S3 Backend Setup                            â”‚
â”‚ 2. Import Existing Resources (AKS, ACR, Key Vault, PostgreSQL)   â”‚
â”‚ 3. Terraform Plan for Azure Resources                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 2: Infrastructure Provisioning (terraform-apply)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Remove Problematic PostgreSQL (Clean state)                   â”‚
â”‚ 2. Terraform Apply (Create/Update):                              â”‚
â”‚    â€¢ Resource Group                                            â”‚
â”‚    â€¢ AKS Cluster with Azure CNI                               â”‚
â”‚    â€¢ Azure Container Registry (ACR)                           â”‚
â”‚    â€¢ Azure Key Vault                                           â”‚
â”‚    â€¢ Key Vault secrets (db credentials)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 3: Container Build & Push (build-and-push)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Login to Azure Container Registry                              â”‚
â”‚ 2. Build & Push Docker Image to ACR                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Phase 4: Kubernetes Deployment (deploy-kubernetes)**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Get AKS Credentials                                            â”‚
â”‚ 2. Create ACR Pull Secret                                        â”‚
â”‚ 3. Install External Secrets Operator                            â”‚
â”‚ 4. Setup External Secrets for Azure Key Vault:                  â”‚
â”‚    â€¢ Create SecretStore (Azure Key Vault)                       â”‚
â”‚    â€¢ Create ExternalSecret (sync from Key Vault)                â”‚
â”‚    â€¢ Fallback to manual secret if needed                        â”‚
â”‚ 5. Deploy Database (PostgreSQL via Helm)                         â”‚
â”‚ 6. Deploy Application (Custom Helm chart)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Destroy Pipeline Phases**

#### **AWS EKS Destroy Pipeline**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Clean Kubernetes Resources (Helm releases, namespaces)         â”‚
â”‚ 2. Delete EKS Node Groups (wait for completion)                  â”‚
â”‚ 3. Delete ElastiCache Cluster (wait for completion)              â”‚
â”‚ 4. Delete RDS Instance (wait for completion)                     â”‚
â”‚ 5. Delete Subnet Groups (after databases deleted) â† KEY FIX     â”‚
â”‚ 6. Delete AWS Secrets Manager Secret                             â”‚
â”‚ 7. Clean ECR Repository Images                                   â”‚
â”‚ 8. Remove Missing Resources from Terraform State                 â”‚
â”‚ 9. Terraform Destroy (VPC, IAM, Security Groups)                 â”‚
â”‚ 10. Final State Cleanup                                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Azure AKS Destroy Pipeline**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 1. Clean Kubernetes Resources                                     â”‚
â”‚ 2. Clean ACR Images                                              â”‚
â”‚ 3. Remove Missing Resources from State                           â”‚
â”‚ 4. Manual Key Vault Cleanup                                      â”‚
â”‚ 5. Terraform Destroy (AKS, ACR, Key Vault, Resource Group)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ **Technical Components**

### **AWS EKS Stack**
| Component | Technology | Purpose |
|-----------|------------|---------|
| **Orchestration** | Amazon EKS | Managed Kubernetes service |
| **Database** | Amazon RDS (PostgreSQL) | Managed database service |
| **Cache** | Amazon ElastiCache (Redis) | In-memory caching |
| **Secrets** | AWS Secrets Manager + External Secrets | Centralized secret management |
| **Networking** | VPC with public/private subnets | Network isolation |
| **Container Registry** | Amazon ECR | Container image storage |
| **IAM** | IRSA (IAM Roles for Service Accounts) | Pod-level AWS permissions |
| **Infrastructure** | Terraform | Infrastructure as Code |
| **CI/CD** | GitHub Actions | Automated deployment |

### **Azure AKS Stack**
| Component | Technology | Purpose |
|-----------|------------|---------|
| **Orchestration** | Azure AKS | Managed Kubernetes service |
| **Database** | PostgreSQL (Helm Chart) | Database running in cluster |
| **Secrets** | Azure Key Vault + External Secrets | Centralized secret management |
| **Networking** | Azure CNI | Native Azure networking |
| **Container Registry** | Azure ACR | Container image storage |
| **Infrastructure** | Terraform | Infrastructure as Code |
| **CI/CD** | GitHub Actions | Automated deployment |

---

## ğŸš€ **Application Access**

### **AWS EKS Application**
- **URL**: `http://<EKS-LoadBalancer-IP>`
- **Database**: RDS PostgreSQL (managed service)
- **Secrets**: Synced from AWS Secrets Manager
- **Scaling**: Auto-scaling node groups

### **Azure AKS Application**
- **URL**: `http://4.156.92.86`
- **Database**: PostgreSQL pod in cluster
- **Secrets**: Synced from Azure Key Vault via External Secrets
- **Key Vault**: `myapp-kv-2024` (stores db-username, db-password)
- **Scaling**: Azure auto-scaling

---

## âš ï¸ **Major Problems Encountered & Solutions**

### **1. External Secrets Webhook Timeout (AWS)**
**Problem**: 
```
failed calling webhook "validate.secretstore.external-secrets.io": 
context deadline exceeded
```

**Root Cause**: External Secrets webhook validation was timing out during SecretStore creation

**Solution**:
- Identified webhook name: `secretstore-validate`
- Deleted webhook before resource creation
- Used `--validate=false` flag
- Created resources immediately after webhook deletion

**Impact**: 3+ hours debugging, multiple pipeline failures

---

### **2. IAM Role Trust Policy Mismatch (AWS)**
**Problem**:
```
AccessDenied: Not authorized to perform sts:AssumeRoleWithWebIdentity
```

**Root Cause**: IAM role trust policy expected `system:serviceaccount:external-secrets:external-secrets` but service account was in `default` namespace

**Solution**:
- Updated trust policy to: `system:serviceaccount:default:external-secrets-sa`
- Created service account in correct namespace
- Restarted External Secrets pods to pick up new IAM role

**Impact**: 2+ hours debugging, authentication failures

---

### **3. VPC Subnet Group Conflicts (AWS)**
**Problem**:
```
CacheSubnetGroupInUse: Cache subnet group is currently in use by a cache cluster
```

**Root Cause**: Destroy pipeline wasn't properly cleaning up subnet groups, causing VPC mismatches on recreation

**Solution**:
- Added proper cleanup order: databases â†’ subnet groups â†’ VPC
- Implemented VPC mismatch detection
- Added resource state management

**Impact**: Multiple infrastructure recreation cycles

---

### **4. Service Account Namespace Issues (AWS)**
**Problem**:
```
ServiceAccount "external-secrets" not found
```

**Root Cause**: External Secrets controller running in `default` namespace couldn't find service account in `external-secrets` namespace

**Solution**:
- Created service account in `default` namespace
- Updated SecretStore to reference correct service account
- Maintained backward compatibility with both service accounts

**Impact**: 1+ hour debugging, secret sync failures

---

### **5. Account ID Retrieval Failures (AWS)**
**Problem**:
```
Role ARN: arn:aws:iam:::role/external-secrets-role (missing account ID)
```

**Root Cause**: AWS CLI command returning empty account ID in CI/CD environment

**Solution**:
- Added debug output for account ID retrieval
- Implemented fallback methods
- Added validation checks

**Impact**: Role ARN malformation, authentication failures

---

### **6. Terraform State Lock Issues**
**Problem**: Multiple pipeline runs causing state lock conflicts

**Solution**:
- Implemented proper error handling
- Added state lock detection
- Graceful failure handling

---

### **7. Resource Import Challenges**
**Problem**: Existing resources not properly imported into Terraform state

**Solution**:
- Created comprehensive import scripts
- Added resource existence checks
- Implemented idempotent operations

---

## ğŸ“Š **Pipeline Optimization**

### **Skip Flags Implementation**
- `[skip-terraform]`: Skip infrastructure changes
- `[skip-build]`: Skip Docker image building
- Deploy-only mode for faster iterations

### **Error Handling Strategy**
- Differentiate between authentic errors and expected failures
- Graceful degradation for missing resources
- Comprehensive logging and diagnostics

---

## ğŸ¯ **Key Achievements**

### **âœ… Successfully Deployed**
1. **Multi-cloud Kubernetes clusters** (AWS EKS + Azure AKS)
2. **External Secrets integration** with AWS Secrets Manager
3. **Database services** (RDS + in-cluster PostgreSQL)
4. **Container registries** (ECR + ACR)
5. **Load balancer access** for both applications
6. **Infrastructure as Code** with Terraform
7. **CI/CD pipelines** with GitHub Actions

### **âœ… Problem-Solving Approach**
1. **Systematic debugging** with detailed logging
2. **Root cause analysis** for each issue
3. **Incremental fixes** with version control
4. **Documentation** of solutions for future reference
5. **Pipeline optimization** for faster iterations

---

## ğŸ”® **Future Improvements**

### **Security Enhancements**
- Implement network policies
- Add pod security standards
- Enable audit logging

### **Monitoring & Observability**
- Add Prometheus/Grafana stack
- Implement distributed tracing
- Set up alerting systems

### **High Availability**
- Multi-region deployments
- Cross-cloud disaster recovery
- Database replication

### **Cost Optimization**
- Implement cluster autoscaling
- Add resource quotas
- Optimize instance types

---

## ğŸƒâ€â™‚ï¸ **Runtime Architecture Details**

### **How Applications Run in Production**

#### **AWS EKS Runtime Environment**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AWS EKS CLUSTER                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Node Group    â”‚    â”‚   Node Group    â”‚    â”‚   Node Group    â”‚        â”‚
â”‚  â”‚   (t3.medium)   â”‚    â”‚   (t3.medium)   â”‚    â”‚   (t3.medium)   â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚
â”‚  â”‚  â”‚    App    â”‚  â”‚    â”‚  â”‚    App    â”‚  â”‚    â”‚  â”‚PostgreSQL â”‚  â”‚        â”‚
â”‚  â”‚  â”‚   Pod 1   â”‚  â”‚    â”‚  â”‚   Pod 2   â”‚  â”‚    â”‚  â”‚   Pod     â”‚  â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚
â”‚  â”‚  â”‚External   â”‚  â”‚    â”‚  â”‚   Helm    â”‚  â”‚    â”‚  â”‚  System   â”‚  â”‚        â”‚
â”‚  â”‚  â”‚Secrets    â”‚  â”‚    â”‚  â”‚  Charts   â”‚  â”‚    â”‚  â”‚   Pods    â”‚  â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        EXTERNAL SERVICES                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   RDS           â”‚    â”‚  ElastiCache    â”‚    â”‚   ECR           â”‚        â”‚
â”‚  â”‚   PostgreSQL    â”‚    â”‚  Redis          â”‚    â”‚   Repository    â”‚        â”‚
â”‚  â”‚   (Multi-AZ)    â”‚    â”‚  (Cluster)      â”‚    â”‚   (Images)      â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Secrets       â”‚    â”‚   Load          â”‚    â”‚   VPC           â”‚        â”‚
â”‚  â”‚   Manager       â”‚    â”‚   Balancer      â”‚    â”‚   Networking    â”‚        â”‚
â”‚  â”‚   (Credentials) â”‚    â”‚   (Public)      â”‚    â”‚   (Subnets)     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### **Azure AKS Runtime Environment**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           AZURE AKS CLUSTER                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Node Pool     â”‚    â”‚   Node Pool     â”‚    â”‚   Node Pool     â”‚        â”‚
â”‚  â”‚   (Standard_D2) â”‚    â”‚   (Standard_D2) â”‚    â”‚   (Standard_D2) â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚
â”‚  â”‚  â”‚    App    â”‚  â”‚    â”‚  â”‚    App    â”‚  â”‚    â”‚  â”‚PostgreSQL â”‚  â”‚        â”‚
â”‚  â”‚  â”‚   Pod 1   â”‚  â”‚    â”‚  â”‚   Pod 2   â”‚  â”‚    â”‚  â”‚   Pod     â”‚  â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚    â”‚                 â”‚        â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚        â”‚
â”‚  â”‚  â”‚External   â”‚  â”‚    â”‚  â”‚   Helm    â”‚  â”‚    â”‚  â”‚  System   â”‚  â”‚        â”‚
â”‚  â”‚  â”‚Secrets    â”‚  â”‚    â”‚  â”‚  Charts   â”‚  â”‚    â”‚  â”‚   Pods    â”‚  â”‚        â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        EXTERNAL SERVICES                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Azure         â”‚    â”‚   Load          â”‚    â”‚   ACR           â”‚        â”‚
â”‚  â”‚   Key Vault     â”‚    â”‚   Balancer      â”‚    â”‚   Repository    â”‚        â”‚
â”‚  â”‚   (Secrets)     â”‚    â”‚   (Public)      â”‚    â”‚   (Images)      â”‚        â”‚
â”‚  â”‚   â€¢ db-username â”‚    â”‚   â€¢ External IP â”‚    â”‚   â€¢ myapp:latestâ”‚        â”‚
â”‚  â”‚   â€¢ db-password â”‚    â”‚   â€¢ Port 80     â”‚    â”‚   â€¢ Auto-build  â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Secret Management Flow**

#### **AWS EKS Secret Flow**
```
AWS Secrets Manager â†’ External Secrets Operator â†’ Kubernetes Secret â†’ Application Pod
       â†‘                        â†‘                        â†‘                    â†‘
   Stores DB              Syncs every 1m           Mounted as           Reads from
   credentials            via IAM role             environment          /var/secrets
```

#### **Azure AKS Secret Flow**
```
Azure Key Vault â†’ External Secrets Operator â†’ Kubernetes Secret â†’ Application Pod
       â†‘                     â†‘                       â†‘                   â†‘
   Stores DB           Syncs via Managed        Mounted as          Reads from
   credentials         Identity                 environment         /var/secrets
```

### **Traffic Flow**

#### **User Request Journey**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Internet  â”‚â”€â”€â”€â–¶â”‚    Load     â”‚â”€â”€â”€â–¶â”‚ Kubernetes  â”‚â”€â”€â”€â–¶â”‚ Application â”‚
â”‚    User     â”‚    â”‚  Balancer   â”‚    â”‚   Service   â”‚    â”‚    Pod      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                  â”‚
                                                                  â–¼
                                                          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                          â”‚  Database   â”‚
                                                          â”‚ (RDS/Pod)   â”‚
                                                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“ˆ **Metrics & Performance**

### **Deployment Times**
- **Full Pipeline**: ~15-20 minutes
- **Deploy-only**: ~3-5 minutes
- **Infrastructure**: ~10-12 minutes

### **Success Rate**
- **Initial Attempts**: ~30% (due to External Secrets issues)
- **After Fixes**: ~95% success rate
- **Deploy-only**: ~98% success rate

### **Resource Utilization**
- **AWS**: EKS cluster + RDS + ElastiCache + ECR
- **Azure**: AKS cluster + ACR
- **Cost**: Optimized for development/testing workloads

---

## ğŸ† **Conclusion**

Successfully implemented a **multi-cloud Kubernetes architecture** with:
- **Robust error handling** and problem resolution
- **Automated CI/CD pipelines** for both clouds
- **Centralized secret management** with External Secrets
- **Infrastructure as Code** with Terraform
- **Production-ready applications** with load balancer access

**The project demonstrates expertise in cloud-native technologies, problem-solving skills, and multi-cloud architecture design.**